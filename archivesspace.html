<!DOCTYPE html>  <html> <head>   <title>archivesspace.sh</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <ul class="sections">           <li id="title">             <div class="annotation">                 <h1>archivesspace.sh</h1>             </div>         </li>                              <li id="section-1">             <div class="annotation">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                                        </div>                          <div class="content"><div class="highlight"><pre><span class="c">#!/bin/sh</span></pre></div></div>                      </li>                              <li id="section-2">             <div class="annotation">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>                           

<h2>BEGIN INIT INFO</h2>

<p>Provides:          archivesspace
Required-Start:    networking
Required-Stop:     networking
Default-Start:     2 3 4 5
Default-Stop:      0 1 6
Short-Description: Start archivesspace/ embedded jetty 
Description:       Start archivesspace.jar using daemonize(1) http://software.clapper.org/daemonize/</p>

<h2>END INIT INFO</h2>

             </div>                          <div class="content"><div class="highlight"><pre><span class="nb">set</span> -e</pre></div></div>                      </li>                              <li id="section-3">             <div class="annotation">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>                           

<p>AS_HOME has a default or can be read from environment</p>

             </div>                          <div class="content"><div class="highlight"><pre><span class="nv">AS_HOME</span><span class="o">=</span><span class="k">${</span><span class="nv">AS_HOME</span><span class="p">-</span><span class="s2">&quot;$HOME/archivesspace&quot;</span><span class="k">}</span>

<span class="nv">PIDFILE</span><span class="o">=</span><span class="nv">$AS_HOME</span>/log/archivesspace.pid
<span class="nv">OUTFILE</span><span class="o">=</span><span class="nv">$AS_HOME</span>/log/stdout.txt
<span class="nv">ERRFILE</span><span class="o">=</span><span class="nv">$AS_HOME</span>/log/stderr.txt

<span class="k">case</span> <span class="s2">&quot;$1&quot;</span> in
start<span class="o">)</span>
  <span class="nb">set</span> -u
  /usr/sbin/daemonize -a -c <span class="nv">$AS_HOME</span> -e <span class="nv">$ERRFILE</span> -o <span class="nv">$OUTFILE</span> -p <span class="nv">$PIDFILE</span> -l <span class="nv">$PIDFILE</span> <span class="se">\</span>
    <span class="nv">$JAVA_HOME</span>/bin/java <span class="se">\</span>
      -XX:MaxPermSize<span class="o">=</span>256m -Xmx256m -Dfile.encoding<span class="o">=</span>UTF-8 <span class="se">\</span>
      -Daspace.config<span class="o">=</span><span class="nv">$AS_HOME</span>/config/config.rb <span class="se">\</span>
      -cp <span class="nv">$AS_HOME</span>/lib/mysql-connector-java-5.1.21.jar:<span class="nv">$AS_HOME</span>/lib/archivesspace.jar <span class="se">\</span>
      org.archivesspace.Main
;;

stop<span class="o">)</span>
  <span class="nv">PID</span><span class="o">=</span><span class="sb">`</span>cat <span class="nv">$PIDFILE</span><span class="sb">`</span>
  <span class="k">if</span> <span class="o">[</span> -f <span class="nv">$PIDFILE</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span><span class="nb">kill</span> -HUP <span class="nv">$PID</span>
    <span class="nb">printf</span> <span class="s2">&quot;%s\n&quot;</span> <span class="s2">&quot;Ok&quot;</span>
    rm -f <span class="nv">$PIDFILE</span>
  <span class="k">else</span>
<span class="k">    </span><span class="nb">printf</span> <span class="s2">&quot;%s\n&quot;</span> <span class="s2">&quot;pidfile not found&quot;</span>
  <span class="k">fi</span>
;;

restart<span class="o">)</span>
  <span class="nv">$0</span> stop
  <span class="nv">$0</span> start
;;

status<span class="o">)</span></pre></div></div>                      </li>                              <li id="section-4">             <div class="annotation">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>                           

<p>if pidof -o %PPID rpc.mountd > /dev/null; then
                    echo "Running"
                    exit 0
            else
                    echo "Not running"
                    exit 1
            fi</p>             </div>                          <div class="content"><div class="highlight"><pre>;;

*<span class="o">)</span>
  <span class="nb">echo</span> <span class="s2">&quot;Usage: $0 {start|stop|restart|status}&quot;</span>
  <span class="nb">exit </span>1
<span class="k">esac</span>

</pre></div></div>                      </li>              </ul>    </div> </body> </html> 